{
  "meta": {
    "instanceId": "life-tips-video-automation"
  },
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 24
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "æ¯æ—¥è§¦å‘å™¨",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "ç”Ÿæ´»å°å¦™æ‹›ä¸»é¢˜åº“",
              "value": "å¨æˆ¿å°æŠ€å·§,æ¸…æ´æ”¶çº³,ç¾å®¹æŠ¤è‚¤,å¥åº·å…»ç”Ÿ,èŠ‚çº¦çœé’±,æ•°ç æŠ€å·§,è¡£ç‰©ä¿å…»,é£Ÿç‰©ä¿å­˜,æ‰‹å·¥åˆ¶ä½œ,å®‰å…¨é˜²æŠ¤,å­¦ä¹ æ•ˆç‡,æ—¶é—´ç®¡ç†,æ¤ç‰©å…»æŠ¤,å® ç‰©æŠ¤ç†,æ—…è¡Œæ”»ç•¥,è¿åŠ¨å¥èº«,å¿ƒç†è°ƒèŠ‚,äººé™…äº¤å¾€,èŒåœºæŠ€èƒ½,ç”Ÿæ´»åˆ›æ„"
            }
          ]
        }
      },
      "id": "topic-pool",
      "name": "ä¸»é¢˜æ± ",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "// éšæœºé€‰æ‹©ä¸€ä¸ªç”Ÿæ´»å°å¦™æ‹›ä¸»é¢˜\nconst topics = $input.first().json['ç”Ÿæ´»å°å¦™æ‹›ä¸»é¢˜åº“'].split(',');\nconst randomTopic = topics[Math.floor(Math.random() * topics.length)];\n\n// ç”Ÿæˆè¯¦ç»†çš„æç¤ºè¯\nconst prompt = `è¯·ç”Ÿæˆä¸€ä¸ªå…³äº\"${randomTopic}\"çš„ç”Ÿæ´»å°å¦™æ‹›è§†é¢‘è„šæœ¬ï¼Œè¦æ±‚ï¼š\n1. å®ç”¨æ€§å¼ºï¼Œæ“ä½œç®€å•\n2. ææ–™å¸¸è§æ˜“è·å¾—\n3. è„šæœ¬é•¿åº¦30-60ç§’\n4. åŒ…å«æ ‡é¢˜ã€æ­¥éª¤è¯´æ˜å’Œæ³¨æ„äº‹é¡¹\n5. è¯­è¨€ç”ŸåŠ¨æœ‰è¶£ï¼Œé€‚åˆçŸ­è§†é¢‘æ ¼å¼\n6. ç¡®ä¿å†…å®¹å®‰å…¨å¯é `;\n\nreturn [{\n  json: {\n    selectedTopic: randomTopic,\n    prompt: prompt,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "id": "generate-prompt",
      "name": "ç”Ÿæˆæç¤ºè¯",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "requestBody": {
          "model": "llama-3.1-70b-versatile",
          "messages": [
            {
              "role": "user",
              "content": "={{ $json.prompt }}"
            }
          ],
          "max_tokens": 1000,
          "temperature": 0.7
        }
      },
      "id": "groq-script-generation",
      "name": "Groqç”Ÿæˆè„šæœ¬",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        900,
        300
      ],
      "credentials": {
        "httpHeaderAuth": "groq_api"
      }
    },
    {
      "parameters": {
        "jsCode": "// è§£æGroq APIå“åº”å¹¶æå–è„šæœ¬å†…å®¹\nconst response = $input.first().json;\nconst scriptContent = response.choices[0].message.content;\n\n// ä»è„šæœ¬ä¸­æå–å…³é”®ä¿¡æ¯\nconst lines = scriptContent.split('\\n');\nlet title = '';\nlet steps = [];\nlet description = '';\n\nlines.forEach(line => {\n  if (line.includes('æ ‡é¢˜') || line.includes('é¢˜ç›®')) {\n    title = line.replace(/.*[:ï¼š]/, '').trim();\n  } else if (line.includes('æ­¥éª¤') || (line.match(/\\d+[.)ã€]/) && line.length > 10)) {\n    steps.push(line.trim());\n  } else if (line.trim().length > 20 && !title) {\n    title = line.trim();\n  }\n});\n\n// ç”Ÿæˆå›¾åƒæç¤ºè¯\nconst imagePrompt = `ç”Ÿæ´»å°å¦™æ‹›æ¼”ç¤ºå›¾ï¼š${title}ï¼Œç®€æ´æ˜äº†çš„æ­¥éª¤å›¾è§£ï¼Œæ˜äº®æ¸…æ™°çš„èƒŒæ™¯ï¼Œå®ç”¨æ•™ç¨‹é£æ ¼`;\n\n// ç”Ÿæˆè¯­éŸ³è„šæœ¬ï¼ˆå»é™¤æ ‡é¢˜ç­‰æ ‡è®°ï¼‰\nconst voiceScript = scriptContent\n  .replace(/æ ‡é¢˜[:ï¼š].*?\\n/g, '')\n  .replace(/æ­¥éª¤[:ï¼š]/g, '')\n  .replace(/æ³¨æ„äº‹é¡¹[:ï¼š]/g, 'æ³¨æ„ï¼š')\n  .replace(/\\d+[.)ã€]/g, '')\n  .trim();\n\nreturn [{\n  json: {\n    title: title || 'å®ç”¨ç”Ÿæ´»å°å¦™æ‹›',\n    fullScript: scriptContent,\n    voiceScript: voiceScript,\n    imagePrompt: imagePrompt,\n    steps: steps,\n    description: `${title} - ç®€å•å®ç”¨çš„ç”Ÿæ´»æŠ€å·§ï¼Œè®©ç”Ÿæ´»æ›´ç¾å¥½ï¼#ç”Ÿæ´»å°å¦™æ‹› #å®ç”¨æŠ€å·§ #ç”Ÿæ´»åˆ†äº«`\n  }\n}];"
      },
      "id": "parse-script",
      "name": "è§£æè„šæœ¬",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1120,
        300
      ]
    },
    {
      "parameters": {
        "url": "https://api.shuttleai.com/v1/images/generations",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer {{ $credentials.shuttleai_api.api_key }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "shuttle-3-diffusion"
            },
            {
              "name": "prompt",
              "value": "={{ $json.imagePrompt }}"
            },
            {
              "name": "n",
              "value": "1"
            },
            {
              "name": "size",
              "value": "1024x1024"
            }
          ]
        }
      },
      "id": "generate-image",
      "name": "ç”Ÿæˆé…å›¾",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1340,
        300
      ]
    },
    {
      "parameters": {
        "url": "https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "={{ $credentials.elevenlabs_api.api_key }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "text",
              "value": "={{ $json.voiceScript }}"
            },
            {
              "name": "model_id",
              "value": "eleven_multilingual_v2"
            },
            {
              "name": "voice_settings",
              "value": "{\"stability\": 0.5, \"similarity_boost\": 0.5, \"style\": 0.0, \"use_speaker_boost\": true}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "arrayBuffer"
            }
          }
        }
      },
      "id": "generate-voice",
      "name": "ç”Ÿæˆè¯­éŸ³",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1340,
        500
      ]
    },
    {
      "parameters": {
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "url": "https://api.creatomate.com/v1/renders",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer {{ $credentials.creatomate_api.api_key }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "template_id",
              "value": "life-tips-template"
            },
            {
              "name": "modifications",
              "value": "{\n  \"title-text\": \"{{ $('parse-script').item.json.title }}\",\n  \"description-text\": \"{{ $('parse-script').item.json.description }}\",\n  \"background-image\": \"{{ $('generate-image').item.json.data[0].url }}\",\n  \"voiceover-audio\": \"data:audio/mp3;base64,{{ $('generate-voice').item.binary.data.data }}\"\n}"
            }
          ]
        }
      },
      "id": "create-video",
      "name": "åˆæˆè§†é¢‘",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1560,
        400
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "your-google-sheet-id",
          "mode": "id"
        },
        "sheetName": "ç”Ÿæ´»å°å¦™æ‹›è§†é¢‘è®°å½•",
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "æ—¥æœŸ": "={{ $now.format('yyyy-MM-dd HH:mm:ss') }}",
            "ä¸»é¢˜": "={{ $('topic-pool').item.json['selectedTopic'] }}",
            "æ ‡é¢˜": "={{ $('parse-script').item.json.title }}",
            "è„šæœ¬": "={{ $('parse-script').item.json.fullScript }}",
            "è§†é¢‘é“¾æ¥": "={{ $json.url }}",
            "çŠ¶æ€": "å·²å®Œæˆ"
          }
        },
        "options": {}
      },
      "id": "log-to-sheet",
      "name": "è®°å½•åˆ°è¡¨æ ¼",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1780,
        400
      ]
    },
    {
      "parameters": {
        "content": "ğŸ‰ æ¯æ—¥ç”Ÿæ´»å°å¦™æ‹›è§†é¢‘ç”Ÿæˆå®Œæˆï¼\n\nğŸ“ **æ ‡é¢˜**: {{ $('parse-script').item.json.title }}\nğŸ¯ **ä¸»é¢˜**: {{ $('topic-pool').item.json['selectedTopic'] }}\nğŸ¬ **è§†é¢‘é“¾æ¥**: {{ $('create-video').item.json.url }}\nâ° **ç”Ÿæˆæ—¶é—´**: {{ $now.format('yyyy-MM-dd HH:mm:ss') }}\n\nå¿«å»æŸ¥çœ‹æ–°çš„ç”Ÿæ´»å°å¦™æ‹›è§†é¢‘å§ï¼ ğŸš€",
        "username": "ç”Ÿæ´»å°å¦™æ‹›Bot",
        "avatarUrl": "https://cdn-icons-png.flaticon.com/512/3094/3094837.png"
      },
      "id": "discord-notification",
      "name": "Discordé€šçŸ¥",
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        2000,
        400
      ]
    }
  ],
  "connections": {
    "æ¯æ—¥è§¦å‘å™¨": {
      "main": [
        [
          {
            "node": "ä¸»é¢˜æ± ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸»é¢˜æ± ": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆæç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆæç¤ºè¯": {
      "main": [
        [
          {
            "node": "Groqç”Ÿæˆè„šæœ¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Groqç”Ÿæˆè„šæœ¬": {
      "main": [
        [
          {
            "node": "è§£æè„šæœ¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§£æè„šæœ¬": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆé…å›¾",
            "type": "main",
            "index": 0
          },
          {
            "node": "ç”Ÿæˆè¯­éŸ³",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆé…å›¾": {
      "main": [
        [
          {
            "node": "åˆæˆè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆè¯­éŸ³": {
      "main": [
        [
          {
            "node": "åˆæˆè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆæˆè§†é¢‘": {
      "main": [
        [
          {
            "node": "è®°å½•åˆ°è¡¨æ ¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®°å½•åˆ°è¡¨æ ¼": {
      "main": [
        [
          {
            "node": "Discordé€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-01-15T10:00:00.000Z",
      "updatedAt": "2024-01-15T10:00:00.000Z",
      "id": "life-tips",
      "name": "ç”Ÿæ´»å°å¦™æ‹›"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-01-15T10:00:00.000Z",
  "versionId": "1"
}